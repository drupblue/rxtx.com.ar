<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es" lang="es" dir="ltr">
  
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
    <title>drupal hostmaster installation | RxTx</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../../sites/rxtx.com.ar/themes/nitobe/favicon/index.ico" type="image/x-icon" />
    <link type="text/css" rel="stylesheet" media="all" href="../../modules/node/node/index.css?1" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/defaults/index.css?1" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/system/index.css?1" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/system-menus/index.css?1" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/user/user/index.css?1" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/comment/comment/index.css?1" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/rxtx.com.ar/themes/nitobe/reset/index.css?1" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/rxtx.com.ar/themes/nitobe/text/index.css?1" />
<link type="text/css" rel="stylesheet" media="screen" href="../../sites/rxtx.com.ar/themes/nitobe/layout/index.css?1" />
<link type="text/css" rel="stylesheet" media="screen" href="../../sites/rxtx.com.ar/themes/nitobe/style/index.css?1" />
<link type="text/css" rel="stylesheet" media="screen" href="../../sites/rxtx.com.ar/themes/nitobe/core/index.css?1" />
<link type="text/css" rel="stylesheet" media="print" href="../../sites/rxtx.com.ar/themes/nitobe/print/index.css?1" />
    <script type="text/javascript" src="../../misc/jquery/index.js?1"></script>
<script type="text/javascript" src="../../misc/drupal/index.js?1"></script>
<script type="text/javascript" src="../../modules/comment/comment/index.js?1"></script>
<script type="text/javascript" src="../../misc/textarea/index.js?1"></script>
<script type="text/javascript" src="../../sites/rxtx.com.ar/themes/nitobe/script/index.js?1"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/", "googleanalytics": { "trackOutgoing": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|avi|csv|doc|exe|flv|gif|gz|jpe?g|js|mp(3|4|e?g)|mov|pdf|phps|png|ppt|rar|sit|tar|torrent|txt|wma|wmv|xls|xml|zip" } });
//--><!]]>
</script>
    <!--[if IE]>
      <link type="text/css" rel="stylesheet" media="screen" href="/sites/rxtx.com.ar/themes/nitobe/fix-ie.css" />
    <![endif]-->
  </head>
  <body class="not-front not-logged-in page-node node-type-story no-sidebars">
    <div id="page" class="container_16">
            <div id="header">
        <div id="headerTitle" class="grid_12">
          <h1><a href="..//" title=""></a></h1>
        </div>
        <div id="search-top" class="grid_4"><form action="http://www.rxtx.com.ar/content/drupal-hostmaster-installation"  accept-charset="UTF-8" method="post" id="search-theme-form">
<div><div id="search" class="container-inline">
  <div class="form-item" id="edit-search-theme-form-1-wrapper">
 <label for="edit-search-theme-form-1">Search this site: </label>
 <input type="text" maxlength="128" name="search_theme_form" id="edit-search-theme-form-1" size="15" value="" title="Introduzca los términos que quiera buscar." class="form-text" />
</div>
<input type="submit" name="op" id="edit-submit-1" value="Buscar"  class="form-submit" />
<input type="hidden" name="form_build_id" id="form-bb780022e47ca72a9c04b76d8cc4ee4a" value="form-bb780022e47ca72a9c04b76d8cc4ee4a"  />
<input type="hidden" name="form_id" id="edit-search-theme-form" value="search_theme_form"  />
</div>

</div></form>
</div>
                <div class="clear"></div>
                <div id="headerLinks" class="grid_16">
                                                      <div class="clear"></div>
                              </div>
        <div class="clear"></div>
        <div id="navphoto" class="grid_16"></div>
      </div><!-- /#header -->
      <div class="rule-top">&nbsp;</div>

      <div id="center">
        <div class="breadcrumb"><a href="..//">Inicio</a></div>                  <div class="headline grid_12 alpha">
            <h2 class="grid_8 alpha">drupal hostmaster installation</h2>                          <div class="timestamp grid_4 omega">10 Feb 2009</div>
                      </div>
          <div class="clear"></div>
                                        <div class="clear-block">
          <div id="node-60" class="node  node-story ">

  <div class="content">
        <p>This article is the first of two regarding the installation of the <a href="http://groups.drupal.org/aegir-hosting-system">Aegir hosting system</a>. Please check this <a href="http://groups.drupal.org/aegir/overview">overview</a> if you are not familiar with this system. </p>
<p>The following steps show a quick installation of a drupal site as a hostmaster. </p>
<p>First I will drop/delete any previous database/directory that might exists. Then, create a new database and download the last code from the drupal 5 cvs branch. I'm using drupal 5 since there's no hostmaster for drupal 6.</p>
<blockquote><p>mysqladmin -u root -p drop hostmaster<br />mysqladmin -u root -p create hostmaster<br />sudo su -s<br />cd /var/hostmaster<br />rm -fr drupal-5<br />cvs -z6 -d:pserver:anonymous:anonymous@cvs.drupal.org:/cvs/drupal co -d drupal-5 -r DRUPAL-5-15 drupal</p></blockquote>
<p>Then we move on into the hostmaster profile installation.</p>
<blockquote><p>cd drupal-5<br />wget <a href="http://hm2.bryght.com/hostmaster-5.x-0.1.tar.gz" title="http://hm2.bryght.com/hostmaster-5.x-0.1.tar.gz">http://hm2.bryght.com/hostmaster-5.x-0.1.tar.gz</a><br />tar zxf hostmaster-5.x-0.1.tar.gz<br />mv hostmaster/modules drupal-5/sites/all/<br />mv hostmaster drupal-5/profiles/</p></blockquote>
<p>This package already includes the modules needed for this installation (cvs_deploy, provision and hosting).</p>
<p>Now, it's time to create the virtual host configuration for this site. Since I'm working locally on an Ubuntu system, be aware that the steps might not be the same for your system.</p>
<p>I created an entry in the<strong> /etc/hosts</strong> file for the hostname I will be using for the hostmaster profile: aegir.</p>
<blockquote><p>127.0.0.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; localhost localhost.localdomain <strong>aegir </strong></p></blockquote>
<p>Then, create the virtualhost configuration file:</p>
<p><strong>/etc/apache2/sites-available/aegir</strong></p>
<blockquote><p>&lt;VirtualHost *&gt;<br />RewriteEngine On<br />&nbsp;&nbsp;&nbsp; ServerAdmin osvaldo@localhost.localdomain<br />&nbsp;&nbsp;&nbsp; ServerName aegir <br />&nbsp;&nbsp;&nbsp; DocumentRoot /var/hostmaster/drupal-5</p>
<p>&nbsp;&nbsp;&nbsp; CustomLog /var/log/apache2/aegir-access.log combined<br />&nbsp;&nbsp;&nbsp; ErrorLog /var/log/apache2/aegir-error.log<br />&nbsp;&nbsp;&nbsp; LogLevel warn<br />&nbsp;&nbsp;&nbsp; ServerSignature On<br />&lt;/VirtualHost&gt;<br />&lt;Directory /var/hostmaster/drupal-5.x&gt;<br />&nbsp;&nbsp;&nbsp; AllowOverride All<br />&nbsp;&nbsp;&nbsp; Options Indexes FollowSymLinks MultiViews<br />&nbsp;&nbsp;&nbsp; Order allow,deny<br />&nbsp;&nbsp;&nbsp; Allow from all<br />&lt;/Directory&gt;<br />Include /var/hostmaster/config/vhost.d/</p></blockquote>
<p>We need to create the directory where the virtualhost information for the new sites we'll be stored in order to be available for the apache web server.</p>
<p>Then we create a new user account which will own this files and which will be used to the hostmaster site operation.</p>
<p>Also, we should enable the new virtualhost site and reload the web server configuration.</p>
<blockquote><p>mkdir -p /var/hostmaster/config/vhost.d<br />adduser hostmaster<br />chown -R hostmaster /var/hostmaster/<br />a2ensite aegir<br />apache2ctl graceful</p></blockquote>
<p>Then, we can proceed to the site installation:<br />
<blockquote><a href="http://aegir/install.php" title="http://aegir/install.php">http://aegir/install.php</a></blockquote></p>
<p>Completing the steps, filling in the required fields:</p>
<blockquote><p>admin<br />admin_passwd<br />my_email@localhost.localdomain</p>
<p>System account: hostmaster<br />Web server group: www-data</p></blockquote>
<p>These were the modules I enabled:</p>
<blockquote><p>•&nbsp; Enabling hosting_cron module<br />• Enabling hosting_alias module<br />• Enabling hosting_signup module</p></blockquote>
<p>Almost at the end, something like this should appear:</p>
<blockquote><p>Set up your hosting framework</p>
<p>&nbsp;&nbsp;&nbsp; * Introduction<br />&nbsp;&nbsp;&nbsp; * User account<br />&nbsp;&nbsp;&nbsp; * Provisioning<br />&nbsp;&nbsp;&nbsp; <strong>* Hosting</strong><br />&nbsp;&nbsp;&nbsp; * Complet</p>
<p>Ensure that you are logged into the shell as root, and then execute the following commands :</p>
<p>cd /var/hostmaster/drupal-5 <br />sites/all/modules/drush/drush.php hosting setup</p></blockquote>
<p>If you do that as the root user, you should had this error message:</p>
<blockquote><p>root@vostro:/var/hostmaster/drupal-5# sites/all/modules/drush/drush.php hosting setup<br />PROVISION_OUTPUT_START&gt;&gt;&gt;a:4:{s:4:"site";a:0:{}s:12:"error_status";i:16;s:3:"log";a:1:{i:0;a:3:{s:4:"type";s:5:"error";s:7:"message";s:62:"You are running the provision script as the root user. Exiting";s:9:"timestamp";i:1234266354;}}s:8:"mroot@vostro:/var/hostmaster/drupal-5# </p></blockquote>
<p>The user account used to execute those commands should be the one you created previously, in this example, the hostmaster account.</p>
<blockquote><p>su - hostmaster<br />cd /var/hostmaster/drupal-5 <br />sites/all/modules/drush/drush.php hosting setup</p></blockquote>
<p>
If this error message appears:</p>
<blockquote><p>hostmaster@vostro:~/drupal-5$ sites/all/modules/drush/drush.php hosting setup<br />Could not create symlink for drush.php (The symlink could not be created, an error has occured)<br />Generating drushrc.php file<br />Could not change permissions of drushrc.php to 600 (chmod to 600 failed on /var/hostmaster/drupal-5/drushrc.php)<br />Platform config file could not be written<br />Could not change permissions of drushrc.php to 400 (chmod to 400 failed on /var/hostmaster/drupal-5/drushrc.php)</p>
<p>The command did not complete successfully, please fix the issues and re-run this script.hostmaster@vostro:~/drupal-5$ <br />hostmaster@vostro:~/drupal-5$ </p></blockquote>
<p>That's permissions problems, log out from the hostmaster account, fix the permissions as the root user and perform again the commands:</p>
<blockquote><p>su - hostmaster<br />cd /var/hostmaster/drupal-5 <br />sites/all/modules/drush/drush.php hosting setup</p></blockquote>
<p></p>
<p>Now everything went ok.</p>
<blockquote><p>hostmaster@vostro:~/drupal-5$ sites/all/modules/drush/drush.php hosting setup<br />Created symlink for drush.php file<br />Generating drushrc.php file<br />Could not change permissions of drushrc.php to 600 (chmod to 600 failed on /var/hostmaster/drupal-5/drushrc.php)<br />Changed permissions of drushrc.php to 400<br />Dispatch command was run successfully<br />Existing hosting dispatch cron entry was found. Not replacing<br />hostmaster@vostro:~/drupal-5$ </p></blockquote>
<p>Once the hostmaster profile installation is finished, we can proceed to create a new site. Just to test it. After that, a task is created. Tasks should be processed via cron, but you could force processing them processing by using these commands.</p>
<blockquote><p>su - hostmaster<br />cd /var/hostmaster/drupal-5 <br />./drush.php hosting tasks</p></blockquote>
      </div>

  <div class="clear-block">
    <div class="meta">
                                </div>

      </div>

</div> <!-- node-story -->
<div id="comments"><h2 class="comments">Comentarios</h2>
</div>
<div class="box">

  <h2>Enviar un comentario nuevo</h2>

  <div class="content"><form action="http://www.rxtx.com.ar/comment/reply/60"  accept-charset="UTF-8" method="post" id="comment-form">
<div><div class="form-item" id="edit-name-wrapper">
 <label for="edit-name">Su nombre: <span class="form-required" title="Este campo es obligatorio.">*</span></label>
 <input type="text" maxlength="60" name="name" id="edit-name" size="30" value="Anonymous" class="form-text required" />
</div>
<div class="form-item" id="edit-mail-wrapper">
 <label for="edit-mail">E-mail: <span class="form-required" title="Este campo es obligatorio.">*</span></label>
 <input type="text" maxlength="64" name="mail" id="edit-mail" size="30" value="" class="form-text required" />
 <div class="description">El contenido de este campo se mantiene privado y no se mostrará públicamente.</div>
</div>
<div class="form-item" id="edit-homepage-wrapper">
 <label for="edit-homepage">Página principal: </label>
 <input type="text" maxlength="255" name="homepage" id="edit-homepage" size="30" value="" class="form-text" />
</div>
<div class="form-item" id="edit-comment-wrapper">
 <label for="edit-comment">Comentario: <span class="form-required" title="Este campo es obligatorio.">*</span></label>
 <textarea cols="60" rows="15" name="comment" id="edit-comment"  class="form-textarea resizable required"></textarea>
</div>
<ul class="tips"><li>Las direcciones de las páginas web y las de correo se convierten en enlaces automáticamente.</li><li>Etiquetas HTML permitidas: &lt;a&gt; &lt;em&gt; &lt;strong&gt; &lt;cite&gt; &lt;code&gt; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &lt;dl&gt; &lt;dt&gt; &lt;dd&gt;</li><li>Saltos automáticos de líneas y de párrafos.</li></ul><p><a href="../../filter/tips/">Más información sobre opciones de formato</a></p><input type="hidden" name="form_build_id" id="form-285a2699e89b6f3aa71d668eb5b520a7" value="form-285a2699e89b6f3aa71d668eb5b520a7"  />
<input type="hidden" name="form_id" id="edit-comment-form" value="comment_form"  />
<input type="submit" name="op" id="edit-submit" value="Guardar"  class="form-submit" />
<input type="submit" name="op" id="edit-preview" value="Previsualizar"  class="form-submit" />

</div></form>
</div>
</div>
</div>        </div>
      </div> <!-- /#center -->
            <div class="clear">&nbsp;</div>
            <div class="rule">&nbsp;</div>
      <div id="footer">
              </div>
    </div> <!-- /container -->
  <script type="text/javascript" src="../../sites/all/modules/google_analytics/googleanalytics/index.js?1"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
try{var pageTracker = _gat._getTracker("UA-5155520-2");pageTracker._trackPageview();} catch(err) {}
//--><!]]>
</script>
<script type="text/javascript">
  $(document).ready(function() {
    var names = [ "http://www.rxtx.com.ar/sites/rxtx.com.ar/themes/nitobe/headers/Wet_Hibiscus_Flower_Macro.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Martian_Surface/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Earth_from_ISS/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Flower_Pattern/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Leek_Bloom/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Contemplation/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Onions_and_Scale/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Tennyson/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Blue_Water_Drops/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/La_Rambla/index.jpg", "../../sites/rxtx.com.ar/themes/nitobe/headers/Rolling_Hills/index.jpg", "http://www.rxtx.com.ar/sites/rxtx.com.ar/themes/nitobe/headers/Metal_Wall.jpg" ];
    $('#navphoto').css('background-image', 'url(' + names[Math.floor(Math.random() * names.length)] + ')');
  });
</script>  </body>

<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>
